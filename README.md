# Проектная работа "Веб-ларек"

## Шутов Кирилл Вячеславович
## 3 курс


Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Архитектура проекта

Основа архитектуры проекта - паттерн MVP:

- Model - предоставляет данные для пользовательского интерфейса.
- View - реализует отображение данных (Модели) и маршрутизацию пользовательских команд или событий Presenterʼу.
- Presenter - управляет Моделью и Представлением.

В качестве точки сборки выступает ./src/index.ts.

В папке src/utils также хранятся вспомогательные функции и константы.

## Пользовательский сценарий

Пользователь выбирает товар на главной странице каталога, после чего Presenter для товара вызывает Model и загружает информацию о продукте. После этого информация отображается с помощью View модального окна продукта. При добавлении товара в корзину Presenter корзины обновляет информацию в Model корзины и обновляет ее View. При оформлении заказа представлением для модальных окон каждого этапа оформления управляет Presenter заказа, который, в свою очередь, обновляет данные для модели заказа. При завершении оформления заказа, вызывается модальное окно об успешном оформлении. Presenter'ы заказа и корзины очищают свои Model'и обновляют view.

## Базовые классы

### EventEmitter

Реализация управления событиями. Наследует интерфейс IEvents.

#### Свойства класса:

- `_events: Map<EventName, Set<Subscriber>>` — private-свойство; Map, в котором хранятся события и подписчики

#### Конструктор класса:

- `constructor()` — создание пустого EventEmitter

#### Методы класса:

- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` — подписка на событие

- `off(eventName: EventName, callback: Subscriber)` — отписка от события

- `emit<T extends object>(eventName: string, data?: T)` — вызов события

- `onAll(callback: (event: EmitterEvent) => void)` — подписка на все доступные события

- `offAll()` — очистка списка событий

- `trigger<T extends object>(eventName: string, context?: Partial<T>)` — создание колбэк триггера, генерирующего событие при вызове

### API

Реализация взаимодействия с REST API.

#### Свойства класса:

- `readonly baseUrl: string` — URL для запросов к API, только для чтения

- `protected options: RequestInit` — параметры запроса

### Конструктор класса:

- `constructor(baseUrl: string, options: RequestInit = {})`

#### Методы класса:

- `protected handleResponse(response: Response): Promise<object>` — обработка ответа сервера. Возвращает данные с сервера / ошибку.

- `get(uri: string): Promise<object>` — отправка GET-запроса по заданному URI. Возвращает данные с сервера.

- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` — отправка POST-запроса по заданному URI. Возвращает результат запроса.


## Model

- `CartModel` - модель работы корзины.

    Функции модели:

    - Добавление товара в корзину

    - Удаление товара из корзины

- `ProductModel` - модель работы товара. 

    Функции модели:

    - Возврат данных о выбранном товаре

- `OrderModel` - модель оформления заказа.

    Функции модели:

    - Обеспечение открытия и закрытия модального окна заказа

    - Реализация логики работы пользователя при оформлении заказа


## View

Все View-классы наследуют абстрактный класс AbstractView.

- `AbstractView` - абстрактный класс представления

- `CatalogView` - класс представления каталога

- `ModalCartView` - класс представления модального окна корзины

- `ModalInfoView` - класс представления модального окна заполнения личной информации

- `ModalPaymentOptionView` - класс представления модального окна выбора способа оплаты

- `ModalProductVIew` - класс представления модального окна товара

- `ModalSucceededView` - класс представления модального окна с сообщением об успешном оформлении заказа

- `ModalView` - класс представления модального окна

- `ProductVIew` - класс представления карточки товара

## Presenter

- `ProductPresenter` - управление карточкой товара и получение данных о товаре

- `CartPresenter` - добавление и удаление товаров в корзине, обновление состояния представления

- `OrderPresenter` - управление информацией о заказе, работа с модальными окнами заказа
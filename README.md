# 3 курс
# Дробышев Дмитрий Игоревич
# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Архитекутура
В этом проекте реализован архитектурный паттерн MVP (Model-View-Presenter).

<p>Model: Слой логики, управляющий данными для корзины и каталога товаров. Включает классы, такие как корзина (Basket) и список товаров (Catalog).
View: Отвечает за отображение данных в интерфейсе приложения. Для взаимодействия между всеми частями используется брокер событий.
Presenter: Управляет обработкой событий, обеспечивает связь между Model и View и отвечает за обновление представлений.</p>

## Описание классов и компонентов

### EventEmitter:
- Служит для управления событиями и позволяет взаимодействовать между компонентами и классами без прямой связи между ними.
- Включает методы для установки и удаления слушателей событий, а также для их вызова.

### Для удобства использования простые типы вынесены в алиасы:

- EventName — тип для имени события: string | RegExp.
- Subscriber — тип для функции-обработчика: Function.
- EmitterEvent — тип для представления события

### Свойства:
- _events — Map, содержащая события и их подписчиков. Ключом является EventName, а значением — множество (Set) функций-подписчиков.
### Методы:
- on(eventName: EventName, callback: (event: T) => void): void
Добавляет обработчик callback для события eventName. Если событие еще не существует, оно создается и добавляется в карту событий.

- off(eventName: EventName, callback: Subscriber): void
Удаляет обработчик callback для события eventName. Если у события не остается подписчиков, оно удаляется из карты событий.

- emit(eventName: string, data?: T): void
Инициирует событие eventName с передачей данных data. Вызовет все функции-подписчики для конкретного события. Если подписка сделана по шаблону RegExp, будет выполнен поиск подходящих событий.

- onAll(callback: (event: EmitterEvent) => void): void
Добавляет обработчик callback, который будет вызываться на все события в брокере. Использует символ "*" для создания общей подписки.

- offAll(): void
Удаляет все обработчики для всех событий, сбрасывая карту _events.

- trigger(eventName: string, context?: Partial<T>): (event: T) => void
Создает функцию-триггер, которая вызывает событие eventName, при этом объединяя данные context и данные из переданного события.

## Описание типов данных

### IProduct
#### Тип данных, описывающий продукт.
- id (string): Уникальный идентификатор продукта.
- description (string): Описание продукта.
- image (string): URL изображения продукта.
- title (string): Название продукта.
- category (string): Категория, к которой относится продукт.
- price (number | null): Цена продукта. Может быть null, если цена отсутствует.
- isBusket (boolean): Находится ли товар в корзине

### IProductsList
#### Интерфейс для управления списком продуктов.
- items (IProduct[] | null): Список всех продуктов. Может быть null, если продукты отсутствуют.
- getItems ((url: string) => Promise<-object->): Метод для загрузки списка продуктов с сервера по указанному url. Возвращает Promise с результатом запроса.

### IBusket
#### Интерфейс, описывающий корзину покупок.
- items (IProductsList[] | null): Список товаров, добавленных в корзину. Может быть null, если корзина пуста.

### IOrder
#### Тип данных, описывающий заказ.
- id (string): Уникальный идентификатор заказа.
- payment (string): Способ оплаты, выбранный для заказа.
- email (string): Электронная почта клиента, оформившего заказ.
- phone (string): Номер телефона клиента.
- address (string): Адрес доставки.
- total (number | null): Общая сумма заказа. Может быть null, если сумма не подсчитана.
- items (string[]): ID продуктов, включенных в заказ.
Перечисление Event
Event — это перечисление, которое содержит строковые константы, представляющие различные действия и события в приложении. Использование перечисления помогает поддерживать консистентность имен событий и предотвращает ошибки при их написании.
## Перечисление Event
### Список событий
| Ключ Enum	| Значение | Описание |
| --------- | -------- | -------- |
BUSKET_OPEN |	busket:open |	Срабатывает при открытии корзины.
BUSKET_CLOSE |	busket:close |	Срабатывает при закрытии корзины.
PRODUCT_CARD_OPEN |	product-card:open |	Срабатывает при открытии карточки товара.
PRODUCT_CARD_CLOSE | product-card:close	| Срабатывает при закрытии карточки товара.
ADD_PRODUCT_TO_BUSKET | busket-product:add | Срабатывает при добавлении товара в корзину.
REMOVE_PRODUCT_FROM_BUSKET | busket-product:remove | Срабатывает при удалении товара из корзины.
LOAD_BUSKET_PRODUCTS | busket-product:load | Срабатывает при загрузке товаров в корзину.
MODAL_OPEN | modal:open | Срабатывает при открытии модального окна.
MODAL_CLOSE | modal:close | Срабатывает при закрытии модального окна.
LOAD_PRODUCTS | products:load | Срабатывает при загрузке товаров в приложение.
ORDER_EMIT | order:emit | Срабатывает при начале оформления заказа.
ORDER_CONTINUE | order:continue | Срабатывает при продолжении оформления заказа.
ORDER_END | order:end | Срабатывает при завершении оформления заказа.
PAY	order:pay | Срабатывает при оплате заказа.
ORDER_ADD_ADDRESS | order:add-address | Срабатывает при добавлении адреса доставки к заказу.
ORDER_ADD_PAYMENT | order:add-payment | Срабатывает при добавлении платежной информации.
ORDER_ADD_PHONE | order:add-phone | Срабатывает при добавлении номера телефона к заказу.
ORDER_ADD_EMAIL | order:add-email | Срабатывает при добавлении email к заказу.

## Массив CardTypes
### Структура CardTypes
| Название (русское) | Идентификатор (англ.) | Описание |
| ------------------ | --------------------- | -------- |
другое | other | Карточки, которые не относятся к другим категориям.
софт-скил | soft | Карточки, связанные с мягкими навыками.
кнопка |button | Карточки, которые выполняют функцию кнопок.
дополнительное | additional | Дополнительные или вспомогательные карточки.
хард-скил | hard | Карточки, связанные с твердыми навыками.

# Взаимодействие компонентов. Слои MVP-паттерна

# Модели (Models)
Модели служат для работы с данными и логикой приложения.

## BusketModel
### Описание
#### Класс BusketModel представляет собой модель корзины, которая хранит товары, добавленные пользователем, и управляет их состоянием.

| Метод / Свойство | Описание |
| ---------------- | -------- |
items | Возвращает список товаров в корзине (массив объектов IProduct).
getProductCount() | Возвращает количество товаров в корзине.
addProduct(product) | Добавляет товар (IProduct) в корзину.
removeProduct(product) | Удаляет товар (IProduct) из корзины.
clearBucket() | Очищает корзину, удаляя все товары.

## MarketPageModel
### Описание
#### Класс MarketPageModel управляет списком товаров на странице магазина и позволяет получить данные о конкретной карточке товара.

| Метод / Свойство | Описание |
| ---------------- | -------- |
items | Возвращает текущий список товаров (IProduct[]).
getAllProducts(items) | Устанавливает список товаров и вызывает событие LOAD_PRODUCTS.
getCurrentCard(cardId) | Возвращает данные о товаре с указанным cardId. Если товар не найден, возвращает undefined.

## OrderModel
### Описание
#### Класс OrderModel управляет данными заказа, включая адрес, контактные данные, способ оплаты, стоимость и список товаров.

| Метод / Свойство | Описание |
| ---------------- | -------- |
setAddress(data) | Устанавливает адрес доставки.
setEmail(data) | Устанавливает email клиента.
setPhone(data) | Устанавливает номер телефона клиента.
setPayment(data) | Устанавливает способ оплаты.
setPrice(data) | Устанавливает общую стоимость заказа.
setItems(items) | Устанавливает список идентификаторов товаров в заказе.
getOrder() | Возвращает объект заказа (IOrder) со всеми данными: адрес, контакты, оплата, стоимость и товары.

# Представления (Views)
В данном проекте реализованы классы для отображения пользовательского интерфейса. Эти классы отвечают за управление визуальными элементами, обработку пользовательских взаимодействий и генерацию DOM-структур.

## BusketButtonView
### BusketButtonView отвечает за отображение кнопки корзины в заголовке и обновление счётчика товаров.

## BusketView
### BusketView отображает содержимое корзины и обрабатывает взаимодействия с товарами внутри корзины.

## MarketPageView
### MarketPageView отвечает за отображение списка товаров на странице магазина.

## MarketPageModalView
### MarketPageModalView отображает модальное окно с содержимым.

## OrderFirstStepView
### OrderFirstStepView отвечает за отображение первого шага оформления заказа (ввод адреса и выбор способа оплаты).

## OrderSecondStepView
### OrderSecondStepView отображает второй шаг оформления заказа (ввод контактных данных).

## OrderFinishStepView
### OrderFinishStepView отображает сообщение о завершении заказа.

## CardActiveView
### CardActiveView отображает подробную информацию о выбранной карточке товара.

## CardDefaultView
### CardDefaultView отображает стандартную карточку товара в списке.

## CardBucketView
### CardBucketView отображает товар в корзине и обрабатывает взаимодействие с ним (например, удаление из корзины).
# Презентеры (Presenters)
Презентеры управляют логикой взаимодействия между Model и View.


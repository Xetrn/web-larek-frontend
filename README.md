# 3 курс
# Дистель Тимур Маратович
# Проектная работа "Веб-ларек"

Проект построен на MVP (Presenter - EventEmitter)

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Интерфейсы

### Интерфейс `IProduct`
#### Определяет структуру объекта продукта. Свойства:

- `id: string` — уникальный идентификатор продукта.
- `description: string` — описание продукта.
- `image: string` — ссылка на изображение продукта.
- `title: string` — название продукта.
- `category: string` — категория продукта.
- `price: number | null` — цена продукта.

### Интерфейс `IProductList`
#### Определяет структуру данных, получаемых с сервера. Свойства:

- `catalog: IProduct[]` — массив товаров, пришедших с сервера.

### Интерфейс `IOrderForm`
#### Представляет данные о форме заказа. Свойства:

- `payment: string` — тип оплаты.
- `address: string` — адрес доставки.
- `phone: string` — номер телефона пользователя.
- `email: string` — email пользователя.
- `total: string | number` — общая сумма корзины.

### Интерфейс `IOrder`
#### Представляет данные о деталях заказа. Свойства:

- `items: string[]` — массив идентификаторов покупаемых продуктов.
- Унаследованы свойства из `IOrderForm`.

### Интерфейс `IBasket`
#### Определяет структуру данных продуктов в корзине. Свойства:

- `id: string` — уникальный идентификатор продукта.
- `title: string` — название продукта.
- `price: number | null` — цена продукта.

### Интерфейс `IResult`
#### Определяет структуру результата запроса. Свойства:

- `id: string` — уникальный идентификатор результата.
- `total: number` — общая сумма, связанная с результатом.

### Интерфейс `IActions`
#### Определяет действия, которые могут быть выполнены. Свойства:

- `onClick: (event: MouseEvent) => void` — обработчик события клика, принимающий объект события `MouseEvent`.

### Тип `Errors`
#### Определяет структуру ошибок для заказа. Свойства:

- `Partial<Record<keyof IOrder, string>>` — объект, где ключи соответствуют свойствам интерфейса `IOrder`, а значения представляют собой строки с сообщениями об ошибках. Может содержать ошибки для некоторых или всех свойств заказа.

## Классы

### Класс `Api`
#### Представляет собой клиент для взаимодействия с REST API.

##### Свойства:

- `baseUrl: string` — базовый URL для запросов к API.
- `options: RequestInit` — параметры запроса, включая заголовки.

##### Методы:

- `constructor(baseUrl: string, options: RequestInit = {})` — инициализация экземпляра с указанным базовым URL и опциональными параметрами запроса.
- `protected handleResponse(response: Response): Promise<object>` — обрабатывает ответ от сервера, возвращает данные или отклоняет промис с ошибкой.
- `get(uri: string): Promise<object>` — выполняет GET-запрос по указанному URI и возвращает данные.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST'): Promise<object>` — выполняет POST-запрос по указанному URI с переданными данными и возвращает результат.

### Класс `EventEmitter`
#### Реализует паттерн "издатель-подписчик" для управления событиями.

##### Свойства:

- `_events: Map<EventName, Set<Subscriber>>` — карта, хранящая события и подписчиков.

##### Методы:

- `constructor()` — инициализация экземпляра с пустой картой событий.
- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` — подписывает обработчик на событие.
- `off(eventName: EventName, callback: Subscriber)` — отписывает обработчик от события.
- `emit<T extends object>(eventName: string, data?: T)` — инициирует событие и уведомляет всех подписчиков.
- `onAll(callback: (event: EmitterEvent) => void)` — подписывает обработчик на все события.
- `offAll()` — сбрасывает все обработчики событий.
- `trigger<T extends object>(eventName: string, context?: Partial<T>)` — возвращает коллбек, который генерирует событие с переданными данными при вызове.

### Класс `ApiModel`
#### Наследуется от класса `Api`, передает и получает данные от сервера.

##### Методы:

- `getListProductCard()` — получает массив объектов (карточек) с сервера.
- `postOrderLot()` — получает ответ от сервера по отправленному заказу.

### Класс `BasketModel`
#### Хранит и работает с данными, полученными от пользователя.

##### Методы:

- `getCounter()` — возвращает количество товаров в корзине.
- `getSumAllProducts()` — считает и возвращает сумму всех товаров в корзине.
- `setSelectedCard()` — добавляет товар в корзину.
- `deleteCardToBasket()` — удаляет товар из корзины.
- `clearBasketProducts()` — очищает все товары из корзины.

### Класс `DataModel`
#### Принимает и хранит данные продуктов, полученные с сервера.

##### Методы:

- `setPreview()` — получает данные карточки, которую открыл пользователь.

### Класс `FormModel`
#### Хранит данные, полученные от пользователя.

##### Методы:

- `setOrderAddress()` — сохраняет адрес пользователя.
- `validateOrder()` — проверяет адрес пользователя и способ оплаты.
- `setOrderData()` — сохраняет номер телефона и почту пользователя.
- `validateContacts()` — проверяет номер телефона и почту пользователя.
- `getOrderLot()` — возвращает объект данных пользователя с выбранными товарами.

### Классы View
#### Позволяют отображать элементы страницы с полученными данными и взаимодействовать с пользователем.

### Класс `Basket`
#### Управляет отображением корзины.

##### Методы:

- `renderHeaderBasketCounter()` — устанавливает количество товаров в корзине.
- `renderSumAllProducts()` — устанавливает сумму всех товаров в корзине.

### Класс `BasketItem`
#### Управляет отображением элементов (продуктов) в корзине.

##### Методы:

- `setPrice()` — принимает цену продукта и возвращает ее в строковом виде.

### Класс `Card`
#### Управляет отображением карточки товара на веб-странице.

##### Методы:

- `setText()` — устанавливает текстовое содержимое HTMLElement.
- `cardCategory()` — создает новый className для HTMLElement.
- `setPrice()` — принимает цену продукта и возвращает ее в строковом виде.

### Класс `CardPreview`
#### Наследуется от класса `Card` и управляет отображением подробного описания карточки товара.

##### Методы:

- `notSale()` — проверяет наличие цены продукта и ограничивает покупку при отсутствии цены.

### Класс `Order`
#### Управляет отображением содержимого модального окна для выбора метода оплаты и адреса.

##### Методы:

- `paymentSelection()` — устанавливает обводку вокруг выбранного метода оплаты.

### Класс `Contacts`
#### Управляет отображением содержимого модального окна для ввода номера телефона и Email.

### Класс `Modal`
#### Управляет отображением модальных окон.

##### Методы:

- `open()` — отображает модальное окно.
- `close()` — закрывает модальное окно.

### Класс `Success`
#### Управляет отображением успешного заказа в модальном окне.
